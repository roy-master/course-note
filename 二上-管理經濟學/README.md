# 期末作業
> 報告 [PPT](https://www.canva.com/design/DAGVqX5YbBA/ozLKQXI0JcsEe50-hywGKg/edit?utm_content=DAGVqX5YbBA&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton)
## 開始前對準備資料的要求
### TEJ
> 下載與登入參考[TEJ操作](TEJ操作.md)

1. 五家公司資料利用TEJ smart Wizard下載後各自分開成資料表，存在Excel中
2. 這次要的資料在這些DB
   - 收盤價 --> TEJ股價資料庫＞未調整股價(月)＞收盤價(元)
   - 成交量 --> TEJ股價資料庫＞未調整股價(月)＞成交量(百萬股)_月
   - PE-ratio --> TEJ股價資料庫＞未調整股價(月)＞本益比-TEJ
   - 單月營收成長率 --> TEJ Company DB＞月營收盈餘＞單月營收成長率％
   - 每股盈餘 --> TEJ IFRS Finance-國際會計準則＞IFRS以合併為主簡表(累計)-全產業＞每股盈餘(記得日期是要下載季資料)

### 中華民國統計資訊網 
> 點擊[網址](https://www.stat.gov.tw/)進入

從這裡取得 經濟成長率、定存利率、通貨膨脹、大盤指數 資料，並合併到Excel表中

### Excel
1. 五家公司資料利用TEJ smart Wizard下載後各自分開成資料表
   - y --> 收盤價
   - x --> 成交量、本益比(PEratio)、單月營收成長率、每股盈餘(EPS)、經濟成長率、定存利率、通貨膨脹、大盤指數
2. 月成交量：從百萬股轉成千股
3. 每股盈餘
   - 要先從「季」資料轉「月」資料，可以用```算EPS轉換.ipynb```處理，使用方法參考[Python處理](Python處理.md)
   - 如果有缺少，可以用```收盤價／本益比```這個公式去計算
4. 如果有遇到成交量太少（從百萬股到千股會變0），可以先下載「每日股票(千股)」的資料，然後丟```日成交量轉月.ipynb```處理，使用方法參考[Python處理](Python處理.md)

### gretl
> 資料處理參考[gretl操作](gretl操作.md)

## 報告內容
### 一、緒論
#### 研究背景
1.	檢驗股價決定模型中的各變數對股價變動的顯著性
2.	構建實證模型來預測台灣上市公司的股價
3.	比較不同的預測模型的預測準確性，以找出最佳的股價預測方法

#### 研究動機

#### 研究目的

### 二、產業探討
#### 產業介紹
> 所屬`產業`介紹、歷史背景、主要產品與業務（建議可以放圖片）

#### 公司介紹
1. 選取五家台灣上市/櫃`公司`，介紹其所屬產業、歷史背景、主要產品與業務（建議可以放圖片）

### 三、研究方法
#### 資料來源與研究期間
- 從台灣經濟新報(TEJ)資料庫下載相同產業的五檔公司
- 資料包含公司股價（收盤價）、公司基本面指標（如每股盈餘、PE ratio、營收增長率、成交量(張)等）、市場因素（如大盤指數）、總體經濟因素（如利率、GDP成長率、通貨膨脹等）等資料。
- 期間為 2000年1月1日 至 2024年9月30日，資料頻率為月資料。

### 五、實證結果分析
#### 0. 公司股價合理性判斷
1. 並提供過去三年的財務數據，包括營收、每股盈餘 (EPS)、股利等。
2. 根據這些財務指標，判斷當前股價是否合理。可透過與同產業內其他公司相比進行合理性分析。

#### 1. 各家交易量、大盤指數的時間趨勢圖&相關係數代表意義(10/22)
繪製每家**公司股價&交易量**、**股價&大盤指數**的`時間趨勢圖`（左軸顯示股價，右軸顯示交易量/大盤指數）、計算`相關係數`，並以文字說明兩者的相關性  
-> `相關係數`：討論「正相關、負相關或無相關」的現象  
-> `時間趨勢圖`：分別顯示出「價量關係」、「系統風險」

#### 2. 各家敘述統計意義(10/22)
各家公司股價、成交量、大盤指數 --> `平均數、標準差、偏態與峰度`  
-> 說明股價的平均數、標準差、偏態與峰度的「投資意義」

#### 3. 五家公司交易量&大盤指數相關係數比較(10/22)
將五家公司的`相關係數`放在一起  
-> 做比較說明

#### 4. 跑CAPM(10/22)
> 計算每家公司的CAPM：`y(個股報酬率-定存利率)、x(大盤報酬率-定存利率) --> 跑OLS最小平方法`

要的是最後檢定跑出來的`T檢定值、P檢定值、ˆβ(估計值)`  
-> 了解個別相對於整個市場的「波動性或系統性風險」，大於1屬於攻擊型；小於1屬於防禦型；β=1表示波動性與市場一致。

#### 5. 顯著變數(10/22)
> 每一檔股票的`x(成交量、本益比、單月營收成長率、每股盈餘、經濟成長率、定存利率、通貨膨脹、大盤指數)`分別跟`y(收盤價)`都各自跑一次最小平方法（OLS）模型。    

要的是x的`Coefficient、std. error、*** `
> [!TIP]
> 格式：  
> Coefficient  
> (std. error)***  
> 
> 舉例：  
> 0.0009  
> (0.0002)***

-> 看哪些變數和股價的變動是`顯著`的。

#### 6. 比較五家公司的顯著變數(10/22)
將五家公司的`顯著變數`放在一起  
-> 看在五家公司中，那些變數是`共同顯著`的。

#### 7. 計算投資報酬率、比較(10/29)
比較五家公司收盤價、大盤的投資報酬率（```取對數再一階差分```）

#### 8. 跑股價報酬率的顯著變數(11/12)
> 每一檔股票的x(```成交量return```、本益比、單月營收成長率、每股盈餘、經濟成長率、定存利率、通貨膨脹、```大盤指數return```)，跟```y(收盤價return)```都各自跑一次模型。  

要的是x的`Coefficient、std. error、*** `，可參考上方的 [六、計算顯著變數](#gretl)  
-> 看哪些變數和股價報酬率的變動是`顯著`的

#### 9. 比較五家公司的報酬率顯著變數(11/12) 
將五家公司的`顯著變數`放在一起  
-> 看在五家公司中，那些變數是`共同顯著`的

#### 10. 多變數預測模型(11/26)
> 選取`跑報酬率顯著變數`的結果中至少3家公司都有顯著的變數作為x，跟y(股價報酬率)跑OLS多變量回歸
要看的是`RMSE`均方根誤差、`MAPE`平均絕對百分比誤差

# 參考資料
1. https://ecotrust-canada.github.io/markdown-toc/
2. 老師的筆記
3. 昀軒ㄉ筆記
